import sqlite3
import pandas as pd
import duckdb as duck

ANC = ['D301.0','habitants desservis par un dispositif anc habitants','DC.196',"tarif moyen d'un contrôle d'installation",'DC.197','recettes totales issues des contrôles',
    'P301.3','taux de conformité des dispositifs anc','VP.166',"nombre d'installations conformes",'VP.167',"nombre total d'installations contrôlées",
    'VP.168','zones anc officiellement délimitées','VP.169',"existence d'un règlement anc validé",'VP.230',"taux de couverture du territoire par anc"]

dict_regions = {
    "AuvergneRhôneAlpes": ["Ain", "Allier", "Ardèche", "Cantal", "Drôme", "Isère","PuyDeDôme", "Rhône", "Savoie", "HauteSavoie"],
    "BourgogneFrancheComté": ["CôtedOr", "Doubs", "Jura", "Nièvre", "HauteSaône", "SaôneEtLoire","Yonne", "TerritoireDeBelfort"],
    "Bretagne": ["Finistère"],
    "CentreValdeLoire": ["Cher", "Indre"],
    "Corse": ["CorseDuSud", "HauteCorse"],
    "GrandEst": ["Ardennes", "Aube", "HauteMarne", "MeurtheEtMoselle","Meuse", "Moselle", "BasRhin", "HautRhin", "Vosges"],
    "HautsDeFrance": ["Aisne", "Nord", "Oise", "PasDeCalais", "Somme"],
    "IleDeFrance": ["ValDoise"],
    "Normandie": ["Calvados", "Orne"],
    "NouvelleAquitaine": ["Corrèze", "Creuse", "Dordogne", "Gironde", "Vienne", "HauteVienne"],
    "Occitanie": ["Aude", "Aveyron", "Gard","Gers", "Hérault", "Lot","Lozère", "HautesPyrénées", "PyrénéesOrientales", "Tarn", "TarnEtGaronne"],
    "PaysDeLaLoire": ["MaineEtLoire", "Sarthe"],
    "ProvenceAlpesCôteDazur": ["HautesAlpes", "AlpesMaritimes"],
    "Guadeloupe": ["Guadeloupe"],
}

dict_depts={"Guadeloupe":["97122","97119","97117","97116","97113","97102"],
            "ValDoise": ["95566","95445","95430","95409","95353","95091","95042","95028",],
            "TerritoireDeBelfort": ["90105","90101","90096","90095","90090","90083","90081","90070","90064","90063","90056","90055","90053","90051","90046","90045","90043","90033","90030","90028","90027","90025","90024","90019","90018","90014","90009",],
            "Yonne": ["89468", "89456", "89422", "89410", "89392", "89391", "89345", "89288", "89285", "89282", "89279", "89276", "89259", "89257", "89255", "89246", "89230", "89219", "89201", "89188", "89182", "89177", "89151", "89130", "89124", "89116", "89115", "89108", "89105", "89099", "89095", "89093", "89085", "89074", "89056", "89028", "89019", "89010"],
            "Vosges": ["88524", "88519", "88512", "88496", "88494", "88492", "88487", "88482", "88481", "88463", "88462", "88448", "88443", "88442", "88440", "88436", "88434", "88421", "88419", "88416", "88415", "88355", "88348", "88345", "88344", "88340", "88338", "88336", "88331", "88326", "88324", "88322", "88316", "88308", "88297", "88285", "88283", "88271", "88268", "88262", "88258", "88245", "88241", "88238", "88236", "88228", "88227", "88225", "88221", "88216", "88215", "88214", "88203", "88197", "88196", "88168", "88157", "88152", "88148", "88141", "88140","88135", "88134", "88130", "88128", "88120", "88111", "88108", "88099", "88091", "88081", "88079", "88078", "88061", "88053", "88051", "88050", "88049", "88028", "88022", "88017"],
            "HauteVienne": ["87183", "87159", "87145", "87105", "87095", "87090", "87074", "87069", "87053", "87047"],
            "Vienne": ["86115"],
            "TarnEtGaronne": ["82195", "82194", "82192", "82188", "82186", "82176", "82175", "82170", "82168", "82167", "82160", "82154", "82150", "82141", "82138", "82130", "82127", "82122", "82121", "82115", "82112", "82101", "82098", "82089", "82073", "82072", "82066", "82065", "82054", "82051", "82044", "82032", "82024", "82022", "82019"],
            "Tarn": ["81324", "81318", "81310", "81299", "81298", "81288", "81272", "81271", "81270", "81269", "81261", "81255", "81238", "81237", "81236", "81231", "81229", "81219", "81214", "81213", "81212", "81210","81205", "81200", "81189", "81179", "81175", "81173", "81162", "81160", "81159", "81157", "81151", "81150", "81142", "81140", "81134", "81127", "81126", "81116", "81102", "81100", "81083", "81081", "81076", "81055", "81053", "81050", "81049", "81032", "81030", "81027", "81025", "81023", "81022", "81015", "81011", "81006", "81003", "81002", "81001"],
            "Somme": ["80786", "80784", "80774", "80769", "80755", "80728", "80719", "80704", "80697", "80694", "80686", "80672", "80671", "80656", "80655", "80643", "80642", "80634", "80630", "80624", "80622","80583", "80569", "80566", "80563", "80559", "80553", "80550", "80530", "80528", "80526", "80525", "80479", "80472", "80466", "80461", "80455", "80439", "80436", "80429", "80426", "80402", "80381", "80310", "80301", "80276", "80273", "80270", "80243", "80210", "80202", "80192", "80187", "80184", "80179", "80138", "80113", "80108", "80089", "80086", "80085", "80083", "80082", "80071", "80068", "80052", "80042", "80013"],
            "Seine-et-Marne": ["77506", "77353", "77341", "77328", "77327", "77277", "77192", "77060", "77046", "77027", "77025"],
            "HauteSavoie": ["74291", "74285", "74236", "74235", "74184", "74146", "74107", "74103", "74099", "74083", "74078", "74033", "74014"],
            "Savoie": ["73330", "73322", "73313", "73299", "73290", "73280", "73271", "73269", "73267", "73261", "73256", "73245", "73206", "73156", "73149", "73147", "73142", "73140", "73138", "73135", "73122", "73117", "73078", "73077", "73047", "73042", "73040", "73028", "73018", "73013", "73012"],
            "Sarthe": ["72382", "72376", "72368", "72361", "72352", "72351", "72342", "72323", "72321", "72308", "72305", "72298", "72294", "72286", "72279", "72278", "72276", "72272", "72269", "72265", "72262", "72261", "72259", "72256", "72245", "72231", "72225", "72220", "72219", "72212", "72204", "72183", "72178", "72161", "72149", "72148", "72141", "72139", "72137", "72128", "72126", "72125", "72114", "72103", "72102", "72094", "72085", "72079", "72076", "72074", "72068", "72062", "72056", "72053", "72046", "72042", "72036", "72034", "72027", "72020", "72011", "72006", "72005"],
            "SaôneEtLoire": ["71532", "71507", "71506", "71498", "71492", "71440", "71427", "71417", "71316", "71287", "71272", "71181", "71164", "71147", "71146", "71145", "71130", "71087", "71080", "71067", "71058", "71057", "71042", "71039", "71036", "71007"],
            "HauteSaône": ["70583", "70582", "70581", "70577", "70565", "70559", "70557","70550", "70549", "70548", "70545", "70540", "70536", "70533", "70531", "70528", "70527","70526", "70525", "70522", "70521", "70515", "70513", "70512", "70500", "70492", "70490","70486", "70485", "70483", "70481", "70479", "70477", "70476", "70472", "70466", "70464","70463", "70461", "70459", "70455", "70452", "70439", "70433", "70425", "70419", "70415","70412", "70411", "70403", "70387", "70385", "70384", "70380", "70373", "70367", "70366","70362", "70360", "70358", "70347", "70342", "70338", "70323", "70322", "70321", "70319","70315", "70310", "70301", "70298", "70290", "70287", "70285", "70284", "70282", "70269","70263", "70261", "70260", "70259", "70258", "70257", "70253", "70249", "70245", "70242","70240", "70236", "70234", "70233", "70232", "70222", "70207", "70198", "70196", "70186","70180", "70179", "70178", "70171", "70166", "70163", "70159", "70158", "70157", "70156","70152", "70141", "70134", "70130", "70129", "70121", "70111", "70104", "70097", "70094","70090", "70088", "70082", "70079", "70069", "70067", "70053", "70051", "70047", "70046","70044", "70039", "70038", "70029", "70023", "70022", "70020", "70017", "70016", "70013","70011", "70010", "70008"],
            "Rhône": ["69296", "69293", "69292", "69290", "69286", "69284", "69283", "69282", "69281", "69279","69278", "69276", "69275", "69273", "69271", "69270", "69269", "69266", "69260", "69259", "69256", "69255", "69249", "69244", "69233", "69212", "69209", "69208", "69207", "69205","69204", "69202", "69199", "69194", "69191", "69190", "69186", "69176", "69168", "69161","69156", "69154", "69153", "69152", "69149", "69143", "69142", "69140", "69135", "69131","69127", "69126", "69125", "69123", "69121", "69116", "69112", "69106", "69100", "69096","69094", "69091", "69089", "69088", "69087", "69086", "69085", "69083", "69081", "69076","69072", "69071", "69069", "69068", "69067", "69063", "69059", "69057", "69055", "69052","69050", "69049", "69047", "69046", "69044", "69043", "69040", "69034", "69033", "69032","69029", "69028", "69027", "69020", "69016", "69009", "69004", "69003", "69002"],
            "HautRhin": ["68386", "68368", "68358", "68349", "68341", "68323", "68321", "68313", "68311", "68304","68302", "68300", "68297", "68290", "68282", "68281","68278", "68271", "68267", "68256", "68255", "68225", "68224", "68219", "68218", "68214", "68201", "68196", "68195", "68192", "68173", "68166", "68154", "68149", "68140", "68126", "68118", "68115", "68084", "68060", "68059", "68056", "68042", "68017", "68012", "68011"],
            "BasRhin": ["67544", "67541", "67531", "67494", "67487", "67474", "67466", "67455", "67451", "67448", "67443", "67432", "67394", "67368", "67351", "67346", "67339", "67327", "67321", "67315", "67308", "67305", "67290", "67288", "67261", "67254", "67232", "67206", "67199", "67165", "67113", "67079", "67066", "67020", "67009"],
            "PyrénéesOrientales": ["66234", "66233", "66232", "66231", "66228", "66227", "66224", "66222", "66220", "66218", "66216", "66213", "66212", "66206", "66205", "66195", "66194", "66193", "66189", "66188", "66187", "66186", "66185", "66184", "66182", "66180", "66179", "66178", "66176", "66174", "66172", "66169", "66167", "66166", "66164", "66160", "66158", "66156", "66155", "66152", "66151", "66145", "66144", "66143", "66142", "66140", "66139", "66138", "66136", "66132", "66130", "66127", "66125", "66121", "66120", "66119", "66118", "66117", "66116", "66113", "66111", "66107", "66101", "66100", "66097", "66096", "66092", "66083", "66082", "66077", "66076", "66075", "66072", "66071", "66069", "66067", "66065", "66062", "66061", "66057", "66056", "66055", "66054", "66049", "66047", "66046", "66043", "66042", "66041", "66039", "66038", "66037", "66035", "66030", "66028", "66027", "66025", "66023", "66021", "66017", "66014", "66012", "66009", "66006", "66005", "66004", "66003"],
            "HautesPyrénées": ["65451", "65420", "65416", "65400", "65389", "65385", "65371", "65370", "65362", "65335", "65329", "65327", "65323", "65322", "65320", "65319", "65309", "65295", "65294", "65279", "65277", "65234", "65221", "65217", "65202", "65194", "65190", "65129", "65094", "65093", "65076", "65064", "65056", "65051", "65036", "65025", "65019", "65017","65016", "65009", "65006"],
            "PuyDeDôme": ["63473", "63470", "63469", "63467", "63465", "63460", "63459", "63451", "63443", "63436", "63434", "63432", "63431", "63423", "63415", "63414", "63406", "63405", "63400", "63397", "63393", "63386", "63385", "63373", "63365", "63363", "63359", "63355", "63353", "63339", "63337", "63332", "63327", "63322", "63320", "63314", "63310", "63304", "63301", "63300", "63298", "63295", "63292", "63291", "63288", "63283", "63280", "63278", "63260", "63258", "63245", "63244", "63238", "63237", "63236", "63228", "63224", "63215", "63212", "63207", "63205", "63203", "63188", "63186", "63179", "63170", "63167", "63165", "63163", "63158", "63150", "63148", "63145", "63142", "63136", "63135", "63132", "63125", "63118", "63115", "63112", "63110", "63108", "63103", "63099", "63094", "63089", "63086", "63067", "63065", "63064", "63060", "63057", "63056", "63055", "63035", "63027", "63023", "63016", "63015", "63013", "63003"],
            "PasDeCalais": ["62907", "62906", "62905", "62903", "62900", "62898", "62897", "62896", "62895", "62891", "62888", "62886", "62885", "62882", "62880", "62879", "62876", "62874", "62863", "62862", "62861", "62860", "62857", "62856", "62855", "62854", "62853", "62852", "62851", "62848", "62847", "62846", "62845", "62843", "62842", "62841", "62840", "62838", "62837", "62836", "62835", "62834", "62831", "62830", "62829", "62828", "62821", "62820", "62818", "62816", "62813", "62812", "62809", "62808", "62805", "62804", "62801", "62800", "62798", "62797", "62796", "62795", "62794", "62793", "62791", "62790", "62789", "62788", "62787", "62785", "62784", "62778", "62777", "62776", "62775", "62774", "62773", "62771", "62770", "62767", "62766", "62763", "62760", "62759", "62756", "62754", "62750", "62748", "62747", "62740", "62737", "62735", "62733", "62732", "62730", "62727", "62726", "62724", "62723", "62720", "62719", "62717", "62716", "62715", "62713", "62708", "62706", "62704", "62702", "62701", "62700", "62699", "62695", "62693", "62686", "62685", "62683", "62679", "62677", "62676", "62674", "62672", "62671", "62670", "62669", "62668", "62666", "62665", "62663", "62662", "62659", "62656", "62652", "62651", "62648", "62647", "62645", "62644", "62642", "62641", "62640", "62639", "62637", "62635", "62634", "62633", "62632", "62631", "62630", "62629", "62628", "62626", "62624", "62623", "62621", "62620", "62617", "62614", "62613", "62607", "62606", "62601", "62600", "62599", "62598", "62597", "62594", "62593", "62591", "62590", "62587", "62586", "62584", "62583", "62580", "62579", "62578", "62576", "62574", "62573", "62572", "62570", "62569", "62566", "62565", "62564", "62563", "62562", "62561", "62558", "62556", "62555", "62553", "62552", "62551", "62548", "62547", "62544", "62542", "62541", "62540", "62539", "62538", "62537", "62536", "62534", "62533", "62532", "62531", "62530", "62529", "62528", "62526", "62524", "62523", "62522", "62520", "62519", "62518", "62517", "62516", "62515", "62512","62511","62510","62509","62508","62507","62506","62504","62502","62501","62500","62498","62497","62495","62493","62490","62489","62488","62486","62484","62480","62479","62477","62475","62473","62471","62464","62463","62462","62459","62457","62456","62455","62454","62453","62451","62450","62445","62443","62441","62440","62439","62438","62436","62435","62432","62430","62429","62427","62425","62422","62421","62418","62416","62415","62413","62412","62410","62407","62406","62404","62401","62400","62399","62397","62396","62395","62393","62391","62387","62386","62385","62381","62380","62379","62378","62377","62376","62375","62373","62372","62371","62370","62367","62366","62364","62363","62362","62361","62358","62357","62356","62355","62352","62351","62350","62349","62348","62347","62345","62344","62342","62341","62340","62337","62334","62333","62330","62328","62326","62325","62321","62316","62314","62313","62311","62310","62309","62306","62303","62302","62301","62296","62292","62291","62286","62285","62283","62279","62278","62277","62276","62274","62273","62272","62271","62270","62269","62268","62266","62265","62262","62260","62259","62258","62256","62255","62252","62251","62250","62249","62248","62246","62245","62240","62239","62238","62236","62232","62230","62229","62224","62223","62222","62221","62219","62218","62217","62215","62214","62213","62211","62209","62208","62204","62203","62202","62200","62199","62198","62197","62195","62194","62191","62190","62188","62187","62186","62183","62181","62180","62178","62177","62174","62170","62168","62167","62166","62163","62162","62161","62154","62150","62148","62141","62140","62137","62135","62133","62132","62131","62130","62129","62127","62126","62123","62122","62121","62120","62119","62118","62113","62112","62111","62109","62107","62105","62104","62103","62102","62100","62096","62093","62092","62091","62090","62088","62084","62083","62082","62080","62079","62078","62077","62076","62074","62072","62071","62070","62069","62068","62067","62066","62065","62064","62063","62061","62059","62058","62057","62051","62050","62049","62048","62046","62045","62043","62039","62038","62035","62034","62033","62032","62031","62030","62029","62028","62027","62026","62023","62022","62020","62019","62018","62012","62011","62010","62009","62006","62005","62003","62002","62001"],
            "Orne": ["61512","61503","61497","61487","61483","61453","61452","61444","61438","61436","61433","61421","61420","61413","61408","61407","61402","61397","61396","61387","61382","61372","61367","61361","61341","61339","61332","61324","61323","61321","61316","61314","61308","61302","61300","61290","61283","61279","61277","61276","61274","61273","61271","61269","61267","61265","61260","61248","61241","61237","61234","61233","61230","61227","61219","61217","61216","61203","61197","61195","61165","61158","61152","61148","61143","61141","61137","61123","61120","61117","61111","61087","61084","61077","61075","61072","61069","61066","61063","61061","61055","61048","61040","61039","61029","61028","61023","61007","61001"],
            "Oise": ["60558","60538","60459","60447","60382","60329","60221","60205","60127","60071","60068"],
            "Nord": ["59521","59488","59295","59149","59122","59102","59074"],
            "Nièvre": ["58023"],
            "Moselle": ["57762","57756","57755","57737","57734","57728","57727","57726","57725","57718","57717","57714","57711","57698","57690","57686","57682","57679","57675","57674","57673","57670","57656","57654","57648","57637","57627","57611","57609","57604","57583","57572","57565","57564","57563","57559","57555","57549","57533","57525","57515","57509","57504","57500","57494","57486","57479","57472","57461","57460","57444","57442","57440","57436","57431","57430","57428","57424","57414","57413","57406","57395","57392","57391","57389","57385","57382","57381","57380","57377","57373","57366","57355","57354","57349","57343","57342","57337","57335","57332","57328","57320","57319","57318","57314","57313","57304","57302","57299","57297","57293","57292","57284","57276","57275","57271","57266","57253","57248","57236","57233","57231","57230","57229","57217","57209","57201","57200","57190","57182","57175","57171","57160","57159","57158","57156","57155","57152", "57148", "57138", "57127", "57122", "57119", "57115", "57105", "57085", "57057", "57056", "57055", "57054", "57052", "57050", "57048", "57047", "57045", "57042", "57040", "57037", "57034", "57029", "57027", "57020", "57015", "57010", "57008", "57007", "57003"],
            "Meuse": ["55583", "55578", "55569", "55560", "55557", "55554", "55552", "55551", "55547", "55531", "55528", "55526", "55525", "55521", "55520", "55510", "55507", "55496", "55493", "55460", "55458", "55457", "55448", "55439", "55429", "55427", "55424", "55414", "55410", "55406", "55400", "55399", "55395", "55388", "55386", "55382", "55378", "55363", "55353", "55340", "55320", "55317", "55311", "55304", "55303", "55295", "55286", "55274", "55272", "55271", "55268", "55263", "55258", "55245", "55243", "55242", "55232", "55222", "55215", "55212", "55198", "55196", "55166", "55163", "55160", "55153", "55148", "55143", "55142", "55134", "55125", "55121", "55114", "55104", "55094", "55093", "55085", "55072", "55069", "55064", "55062", "55060", "55057", "55042", "55021", "55012", "55011", "55001"],
            "MeurtheEtMoselle": ["54578", "54549", "54547", "54530", "54526", "54519", "54498", "54496", "54495", "54482", "54449", "54439", "54438", "54421", "54395", "54365", "54357", "54350", "54339", "54328", "54304", "54300", "54298", "54291", "54288", "54274", "54265", "54262", "54257", "54237", "54229", "54220", "54211", "54205", "54197", "54190", "54184", "54165", "54164", "54156", "54148", "54135", "54116", "54101", "54097", "54088", "54086", "54077", "54065", "54058", "54055", "54047", "54046", "54040", "54039", "54025", "54016", "54011", "54010"],
            "HauteMarne": ["52549", "52548", "52543", "52534", "52528", "52526", "52515", "52490", "52484", "52455", "52446", "52438", "52433", "52423", "52407", "52405", "52383", "52364", "52336", "52320", "52304", "52303", "52292", "52289", "52287", "52257", "52256", "52249", "52247", "52246", "52243", "52234", "52233", "52227", "52217", "52216", "52200", "52174", "52170", "52161", "52158", "52133", "52132", "52127", "52126", "52122", "52115", "52101", "52079", "52074", "52070", "52067", "52064", "52063", "52060", "52038", "52023", "52022", "51276"],
            "MaineEtLoire": ["49381", "49377", "49373", "49371", "49355", "49353", "49352", "49345", "49339", "49338", "49336", "49332", "49329", "49326", "49323", "49310", "49307", "49306", "49301", "49299", "49298", "49294", "49278", "49271", "49267", "49261", "49246", "49244", "49241", "49240", "49236", "49231", "49223", "49218", "49214", "49211", "49200", "49195", "49193", "49192", "49135", "49130", "49129", "49109", "49102", "49099", "49092", "49082", "49070", "49069", "49058", "49057", "49055", "49048", "49035", "49028", "49027", "49023", "49020", "49015", "49007"],
            "Lozère": ["48194", "48191", "48188", "48187", "48181", "48178", "48169", "48168", "48165", "48163", "48158", "48153", "48146","48144","48140","48138","48132","48131","48124","48123","48119","48107","48104","48103","48099","48098","48097","48095","48094","48092","48091","48089","48088","48086","48085","48080","48072","48068","48061","48050","48046","48045","48038","48034","48032","48020","48017","48008","48005","48003","48002"],
            "Lot": ["47315","47113","47067","46339","46319","46318","46317","46313","46311","46306","46301","46296","46295","46292","46284","46281","46280","46273","46271","46251","46250","46246","46243","46242","46238","46237","46231","46229","46228","46225","46223","46222","46221","46218","46213","46208","46205","46200","46193","46189","46184","46182","46177","46176","46171","46169","46165","46163","46159","46147","46136","46134","46133","46132","46130","46126","46124","46123","46122","46120","46117","46114","46111","46108","46107","46102","46097","46093","46089","46088","46076","46075","46066","46064","46062","46060","46058","46053"],
            "Jura": ["39319","39317","39315","39312","39296","39290","39263","39251","39235","39223","39219","39203","39194","39190","39185","39167","39159","39156","39154","39151","39137","39129","39104","39088","39086","39081","39073","39062","39057","39056","39053","39049","39043","39028","39025","39019","39016","39013","39006","39003","39002"],
            "Isère": ["38522","38518","38465","38456","38448","38442","38405","38402","38378","38377","38357","38332","38313","38292","38280","38269","38217","38212","38194","38183","38182","38124","38113","38107","38104","38065","38063","38055","38050","38046","38030","38029","38022","38012","38001"],
            "Indre": ["37259","36248","36236","36234","36226","36224","36222","36221","36220","36213","36211","36210","36200","36197","36194","36192","36190","36186","36184","36179","36178","36176","36172","36167","36165","36164","36163","36159","36143","36140","36138","36137","36132","36130","36129","36128","36127","36121","36120","36119","36114","36112","36109","36108","36105","36104","36100","36098","36096","36091","36089","36087","36078","36076","36071","36066","36064","36063","36061","36060","36058","36057","36051","36046","36044","36043","36038","36031","36027","36025","36019","36017","36016","36005","36003"],
            "Hérault": ["34340","34338","34329","34319","34317","34310","34306","34303","34294","34291","34288","34283","34278","34277","34258","34253","34251","34247","34246","34243","34230","34229","34225","34224","34223","34220","34212","34196","34191","34189","34188","34183","34181","34180","34178","34161","34155","34148","34142","34135","34109","34106","34105","34104","34091","34089","34079","34074","34072","34064","34061","34036","34026","34008"],
            "Gironde": ["33463","33444","33440","33428","33427","33403","33367","33352","33323","33111","33102"],
            "Gers": ["32462","32456","32440","32425","32406","32393","32389","32388","32382","32362","32360","32346","32343","32332","32326","32317","32315","32301","32293","32285","32265","32257","32256","32254","32237","32231","32221","32217","32215","32199","32187","32183","32172","32165","32162","32159","32157","32156","32144","32128","32123","32111","32110","32109","32104","32097","32088","32077","32076","32072","32071","32065","32056","32054","32045","32043","32042","32036","32033","32032","32030","32029","32013","32012","32009","32003","32002"],
            "Gard": ["30354","30352","30350","30349","30343","30337","30330","30327","30324","30320","30316","30314","30306","30301","30300","30295","30290","30286","30279","30272","30271","30268","30267","30266","30262","30256","30249","30247","30245","30244","30242","30235","30234","30232","30231","30229","30218","30216","30215","30212","30208","30205","30204","30200","30198","30194","30193","30186","30184","30183","30182","30181","30172","30171","30168","30166","30163","30162","30160","30152","30148","30146","30144","30143","30138","30137","30136","30135","30131","30130","30129","30119","30116","30115","30114","30110","30106","30105","30104","30098","30095","30094","30091","30090","30089","30088","30085","30082","30071","30068","30067","30066","30062","30058","30056","30054","30053","30046","30045","30043","30041","30031","30023","30020","30018","30016","30009","30008","30005","30002"],
            "HauteCorse": ["2B355","2B353","2B347","2B346","2B344","2B340","2B338","2B337","2B334","2B333","2B321","2B318","2B309","2B305","2B301","2B299","2B298","2B297","2B296","2B292","2B291","2B289","2B287","2B283","2B281","2B273","2B267","2B264","2B263","2B260","2B257","2B256","2B255","2B252","2B250","2B246","2B241","2B239","2B238","2B234","2B233","2B227","2B224","2B222","2B221","2B220","2B219","2B217","2B214","2B213","2B208","2B206","2B202","2B194","2B188","2B187","2B185","2B184","2B183","2B179","2B178","2B177","2B176","2B171","2B164","2B161","2B159","2B157","2B152","2B147","2B145","2B137","2B122","2B121","2B120","2B116","2B111","2B110","2B109","2B106","2B105","2B096","2B095","2B088","2B086","2B082","2B081","2B078","2B077","2B074","2B073","2B068","2B067","2B063","2B059","2B058","2B057","2B054","2B052","2B051","2B049","2B039","2B033","2B030","2B029","2B023","2B016","2B013","2B012","2B007","2B005"],
            "CorseDuSud": ["2A197","2A154","2A146","2A104","2A085","2A056","2A031"],
            "Finistère": ["29298", "29248", "29225", "29215", "29214", "29174", "29167", "29159", "29152", "29108", "29077", "29070", "29065", "29062", "29055", "29026"],
            "EureEtLoir": ["28426", "28422", "28411", "28410", "28407", "28406", "28400", "28395", "28392", "28391", "28390", "28389", "28385", "28382", "28378", "28364", "28363", "28359", "28353", "28330", "28324", "28313", "28304", "28303", "28300", "28296", "28291", "28287", "28284", "28283", "28282", "28274", "28272", "28270", "28268", "28261", "28257", "28252", "28251", "28236", "28234", "28230", "28222", "28221", "28219", "28215", "28212", "28211", "28207", "28199", "28190", "28189", "28178", "28176", "28175", "28166", "28164", "28161", "28157", "28156", "28142", "28139", "28129", "28127", "28111", "28108", "28091", "28081", "28074", "28072", "28067", "28065", "28049", "28047", "28038", "28032", "28031", "28029", "28028", "28025", "28023", "28021", "28019", "28010", "28009", "28007", "28005"],
            "Drôme": ["26364", "26346", "26336", "26309", "26289", "26288", "26248", "26243", "26238", "26236", "26234", "26220", "26204", "26198", "26195", "26183", "26176", "26175", "26131", "26114", "26112", "26108", "26035", "26034", "26025", "26011"],
            "Doubs": ["25634", "25633", "25632", "25630", "25628", "25627", "25621", "25620", "25614", "25609", "25605", "25601", "25600", "25597", "25586", "25582", "25580", "25578", "25574", "25572", "25569", "25567", "25565", "25558", "25555", "25554", "25553", "25552", "25549", "25547", "25546", "25545", "25541", "25539", "25535", "25533", "25526", "25525", "25520", "25517", "25515", "25514", "25511", "25507", "25505", "25494", "25489", "25486", "25471", "25462", "25460", "25459", "25453", "25447", "25446", "25443", "25442", "25437", "25435", "25434", "25432", "25428", "25425", "25424", "25417", "25406", "25405", "25404", "25401", "25398", "25388", "25385", "25384", "25380", "25377", "25375", "25370", "25367", "25365", "25362", "25360", "25359", "25357", "25355", "25350", "25348", "25347", "25346", "25344", "25343", "25342", "25339", "25334", "25333", "25331", "25327", "25320", "25311", "25310", "25309", "25308", "25307", "25305", "25304", "25301", "25300", "25295", "25293", "25290", "25289", "25285", "25284", "25283", "25282", "25279", "25278", "25273", "25271", "25270", "25268", "25261", "25254", "25252", "25247", "25245", "25243", "25237", "25236", "25233", "25231", "25230", "25229", "25228", "25227", "25223", "25222", "25220", "25218", "25211", "25208", "25204", "25203", "25199", "25196", "25190", "25189", "25188", "25180", "25175", "25170", "25166", "25161", "25157", "25155", "25151", "25141", "25139", "25134", "25129", "25125", "25122", "25120", "25116", "25113", "25110", "25109", "25106", "25099", "25098", "25097", "25095", "25094", "25089", "25078", "25070", "25067", "25060", "25058", "25057", "25053", "25051", "25048", "25044", "25043", "25040", "25039", "25031", "25029", "25024", "25020", "25019", "25018", "25016", "25015", "25011", "25009", "25007", "25006", "25003"],
            "Dordogne": ["24550", "24428", "24388", "24356", "24142", "24076", "24067", "24015"],
            "Creuse": ["23263", "23250", "23247", "23208", "23206", "23201", "23170", "23169", "23154","23150", "23141", "23128", "23105", "23092", "23075", "23052", "23002"],
            "CôtedOr": ["21717", "21483", "21346", "21290", "21154", "21127", "21087"],
            "Corrèze": ["19285", "19284", "19281", "19277", "19256", "19249", "19234", "19232", "19231", "19228", "19227", "19226", "19219", "19215", "19211", "19210", "19207", "19204", "19202", "19200", "19188", "19178", "19175", "19174", "19162", "19160", "19159", "19148", "19141", "19140", "19134", "19125", "19123", "19114", "19113", "19110", "19108", "19103", "19102", "19100", "19090", "19086", "19085", "19083", "19082", "19080", "19078", "19070", "19065", "19064", "19062", "19058", "19056", "19055", "19045", "19042", "19039", "19002", "19001"],
            "Cher": ["18288", "18284", "18280", "18278", "18274", "18272", "18267", "18266", "18264", "18259", "18258", "18257", "18256", "18255", "18254", "18252", "18249", "18248", "18246", "18245", "18243", "18238", "18232", "18230", "18229", "18226", "18218", "18217", "18213", "18212", "18209", "18208", "18205", "18204", "18203", "18193", "18192", "18189", "18187", "18180", "18179", "18178", "18176", "18174", "18171", "18169", "18168", "18157", "18153", "18152", "18149", "18145", "18138", "18136", "18135", "18134", "18130", "18129", "18126", "18125", "18122", "18117", "18115", "18114", "18112", "18109", "18108", "18107", "18096", "18093", "18089", "18087", "18086", "18084", "18083", "18073", "18071", "18064", "18059", "18057", "18055", "18051", "18050", "18046", "18044", "18041", "18040", "18035", "18034", "18033", "18032", "18030", "18028", "18026", "18024", "18014", "18010", "18009", "18008", "18006", "18001"],
            "Cantal": ["15268", "15265", "15259", "15258", "15254", "15250", "15243", "15242", "15236", "15226", "15223", "15222", "15216", "15214", "15206", "15201", "15194", "15192", "15187", "15186", "15183", "15173", "15166", "15163", "15161", "15159", "15156", "15154", "15152", "15147", "15146", "15144", "15131", "15129", "15128", "15126", "15124", "15122", "15121", "15117", "15111", "15110", "15104", "15100", "15098", "15093", "15090", "15089", "15081", "15077", "15073", "15064", "15060", "15058", "15055", "15054", "15045", "15040", "15037", "15030", "15025", "15024", "15019", "15017", "15015", "15008", "15007", "15003", "15002", "15001"],
            "Calvados": ["14762", "14760", "14756", "14752", "14743", "14741", "14708", "14689", "14656", "14650", "14648", "14639", "14635", "14626", "14625", "14607", "14602", "14595", "14579", "14574", "14572", "14570", "14550", "14522", "14520", "14515", "14512", "14510", "14509", "14496", "14491", "14487", "14475", "14474", "14449", "14448", "14435", "14431", "14425", "14421", "14419", "14412", "14411", "14398", "14390", "14389", "14384", "14379", "14371", "14366", "14357", "14353", "14347", "14343", "14337", "14335", "14303", "14241", "14228", "14226", "14225", "14202", "14197", "14183", "14177", "14174", "14172", "14171", "14162", "14146", "14143", "14080", "14069", "14037", "14027", "14011", "14007"],
            "Aveyron": ["12291", "12270", "12160"],
            "Aude": ["11433", "11426", "11422", "11416", "11411", "11410", "11400", "11397", "11395", "11392", "11391", "11386", "11372", "11368", "11363"],
            "Aube": ["10074", "10073", "10072", "10071", "10069", "10068", "10067", "10066", "10065", "10064", "10063", "10062", "10061", "10060", "10059", "10058", "10057", "10056", "10055", "10054", "10053", "10052", "10051", "10050", "10049", "10047", "10046", "10045", "10044", "10043", "10041", "10039", "10038", "10035", "10033", "10031", "10030", "10028", "10027", "10026", "10025", "10024", "10023", "10021", "10020", "10019", "10017", "10015", "10014", "10013", "10012", "10011", "10010", "10009", "10008", "10007", "10005", "10004"],
            "Ardennes": ["08465", "08439", "08432", "08425", "08421", "08406", "08383", "08382", "08372", "08360", "08358", "08334", "08333", "08321", "08311", "08305", "08295", "08277", "08272", "08268", "08254", "08244", "08237", "08223", "08208", "08207", "08192", "08182", "08178", "08168", "08167", "08161", "08159", "08145", "08113", "08098", "08088", "08082", "08076", "08063", "08033", "08016"],
            "Ardèche": ["07348", "07341", "07339", "07330", "07329", "07315", "07287", "07286", "07276", "07273", "07272", "07269", "07263", "07249", "07248", "07247", "07242", "07239", "07222", "07220", "07215", "07212", "07209", "07208", "07204", "07202", "07192", "07190", "07165", "07163", "07159", "07151", "07150", "07145", "07138", "07131", "07129", "07126", "07123", "07108", "07104", "07103", "07095", "07092", "07082", "07080", "07079", "07077", "07073", "07065", "07064", "07054", "07049", "07032", "07012", "07006", "07001"],
            "Alpes-de-Haute-Provence": ["06131", "06087", "06082", "06063", "06053", "06045"],
            "HautesAlpes": ["05184", "05182", "05180", "05178", "05172", "05170", "05164", "05148", "05133", "05131", "05122", "05093", "05090", "05087", "05086", "05074", "05073", "05071", "05070", "05065", "05064", "05063", "05058", "05056", "05048", "05033", "05032", "05022", "05019", "05008", "05001"],
            "AlpesMaritimes": ["04242", "04240", "04236", "04229", "04219", "04218", "04214", "04209", "04201", "04200", "04199", "04193", "04188", "04187", "04180", "04174", "04171", "04162", "04160", "04145", "04144", "04143", "04140", "04139", "04134", "04130", "04127", "04122", "04120", "04110", "04104", "04095", "04093", "04090", "04076", "04075", "04073", "04067", "04065", "04062", "04061", "04055", "04053", "04051", "04031", "04027", "04025", "04022", "04008"],
            "Allier": ["03321", "03316", "03307", "03292", "03290", "03287", "03281", "03275", "03267", "03260", "03229", "03214", "03202", "03183", "03176", "03169", "03163", "03162", "03134", "03121", "03099", "03092", "03085", "03083", "03073", "03065", "03049", "03040", "03039", "03038", "03026", "03013", "03011"],
            "Aisne": ["02755", "02751", "02661", "02589", "02583", "02499", "02490", "02429", "02205", "02155", "02108"],
            "Ain": ["01415", "01411", "01379", "01366", "01342", "01310", "01297", "01280", "01262", "01219", "01216", "01208", "01194", "01166", "01157", "01142", "01089", "01049", "01047", "01034", "01030", "01027", "01010"],
            "Val-d'Oise": ["95637", "95607", "95582", "95572", "95563", "95510", "95500", "95491", "95488", "95476", "95450", "95424", "95422"]
}

dict_indicateurs={}
cnx = sqlite3.connect('Indicateur_des_services.db')
requete="""select code_indicateur,nom_indicateur from Indicateur;"""
x=pd.read_sql_query(requete,cnx)
for i in range (0,53):
    dict_indicateurs[x['code_indicateur'][i]]=x['nom_indicateur'][i]


con = duck.connect()
tab_reg=pd.DataFrame()
index=0
for regions, departements in dict_regions.items():
    for depts in departements :
        for communes in dict_depts[depts]:
            tab_reg.at[index, 'code_commune']=communes
            tab_reg.at[index,'departement']=depts
            tab_reg.at[index, 'region']=regions
            index+=1
con.register('tab_reg', tab_reg)
